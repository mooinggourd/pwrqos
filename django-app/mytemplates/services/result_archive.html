{% extends "services/base.html" %}

{% block content %}

<h1>Wyniki pomiarów</h1>

{% if values %}
    <table class="result-table">
        <tr>
            <th>Wartość</th>
            <th>Typ</th>
            <th>Metryka</th>
            <th>Testowana metoda</th>
            <th>Czas pomiaru</th>
        </tr>        
    {% for m in values %}
        {% if forloop.counter0|divisibleby:"2" %}
        <tr class="even">
        {% else %}
        <tr>
        {% endif %}
            <td>{{ m.value }}</td>
            <td>{{ m.kind.name }}</td>
            <td>{{ m.measurement.metric.name }}</td>
            <td>{{ m.measurement.tested_method.name }}</td>
            <td>{{ m.measurement.time }}</td>
        </tr>
    {% endfor %}    
    </table>

    <div class="pagination">
        <span class="step-links">
            {% if values.has_previous %}
                <button id="btn_prev" type="submit" class="button gray">Poprzednia</button>
            {% endif %}

            <span class="current">
                Strona {{ values.number }} z {{ values.paginator.num_pages }}.
            </span>

            {% if values.has_next %}
                <button id="btn_next" type="submit" class="button gray">Następna</button>
            {% endif %}
        </span>
    </div>

{% else %}
{% if not form.errors and form.is_bound %}
<strong>
    Nie znaleziono żadnych pomiarów dla zadanych kryteriów wyszukiwania.
</strong>
{% endif %}
{% endif %}

<form action="" method="post">{% csrf_token %}
    <table>
    {{ form.as_table }}
    </table> 
    <div id="button-area">
        <input id="btn_submit" type="submit" value="Szukaj" class="green" />
    </div>
</form>

<script type="text/javascript">

$(function() {
    // obsługa podziału wyników na strony
    
    $('#btn_submit').click(function() {
        $('#id_page').val('1');
        return true;
    });

    $('#btn_next').click(function() {
        $('#id_page').val('{{ values.next_page_number }}');
        $('form').submit();
    });

    $('#btn_prev').click(function() {
        $('#id_page').val('{{ values.previous_page_number }}');
        $('form').submit();
    });
});

</script>

{% endblock %}
